================================================================================
TÃNH NÄ‚NG BIá»‚U Cáº¢M TIN NHáº®N (Message Reactions Feature)
================================================================================

NGÃ€Y Táº O: 21/12/2025
LOáº I: Feature
TÃNH NÄ‚NG: Reaction/emoji cho tin nháº¯n trong cuá»™c trÃ² chuyá»‡n
KIáº¾N TRÃšC: MVVM (Repository â†’ ViewModel â†’ View)

================================================================================
1. Tá»”NG QUAN
================================================================================

TÃ­nh nÄƒng cho phÃ©p ngÆ°á»i dÃ¹ng thá»ƒ hiá»‡n cáº£m xÃºc (react) vá»›i tin nháº¯n báº±ng cÃ¡ch 
thÃªm emoji reactions. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ xem thá»‘ng kÃª reactions vÃ  xÃ³a táº¥t cáº£ 
reactions cá»§a má»™t tin nháº¯n.

TÃNH NÄ‚NG CHÃNH:
- 6 loáº¡i reactions: â¤ï¸ Heart, ğŸ˜‚ Haha, ğŸ˜¢ Sad, ğŸ˜  Angry, ğŸ˜® Wow, ğŸ‘ Like
- Long-press tin nháº¯n Ä‘á»ƒ má»Ÿ reaction picker
- Click vÃ o reaction hiá»‡n cÃ³ Ä‘á»ƒ thay Ä‘á»•i reaction cá»§a mÃ¬nh
- Hiá»ƒn thá»‹ tá»•ng sá»‘ reactions vÃ  biá»ƒu tÆ°á»£ng phá»• biáº¿n nháº¥t
- NÃºt X Ä‘á»ƒ xÃ³a Táº¤T Cáº¢ reactions cá»§a tin nháº¯n (reset vá» 0)
- Smooth UI updates khÃ´ng gÃ¢y nháº¥p nhÃ¡y hoáº·c auto-scroll khÃ´ng mong muá»‘n

================================================================================
2. DATA MODEL CHANGES
================================================================================

2.1. MESSAGE MODEL (models/Message.java)

ThÃªm cÃ¡c fields má»›i Ä‘á»ƒ lÆ°u trá»¯ reactions:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Field               â”‚ Type                  â”‚ MÃ´ táº£                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ reactions           â”‚ Map<String, String>   â”‚ userId â†’ reactionType         â”‚
â”‚ reactionCounts      â”‚ Map<String, Integer>  â”‚ reactionType â†’ count          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ThÃªm methods:
- hasReactions(): boolean - Kiá»ƒm tra tin nháº¯n cÃ³ reactions hay khÃ´ng
- getUserReaction(userId): String - Láº¥y reaction type cá»§a user cá»¥ thá»ƒ
- getTotalReactionCount(): int - Tá»•ng sá»‘ reactions
- Getters/Setters cho Firestore serialization

2.2. MESSAGE REACTION CONSTANTS (models/MessageReaction.java)

CÃ¡c constants Ä‘á»‹nh nghÄ©a reaction types:
- REACTION_HEART = "heart"
- REACTION_HAHA = "haha" 
- REACTION_SAD = "sad"
- REACTION_ANGRY = "angry"
- REACTION_WOW = "wow"
- REACTION_LIKE = "like"

Helper methods:
- isValidReactionType(String): boolean - Validate reaction type
- getReactionTypeCounts(Map, Map): Map - TÃ­nh toÃ¡n counts tá»« reactions map
- getMostCommonReaction(Map): String - Láº¥y reaction type phá»• biáº¿n nháº¥t

2.3. FIRESTORE STRUCTURE

conversations/{conversationId}/messages/{messageId}
  - (cÃ¡c fields hiá»‡n táº¡i)
  - reactions: map
      - {userId1}: "heart"
      - {userId2}: "haha"
      - ...
  - reactionCounts: map
      - "heart": 5
      - "haha": 3
      - "sad": 1
      - ...

================================================================================
3. UI COMPONENTS
================================================================================

3.1. LAYOUTS Má»šI

layout_reaction_picker.xml
- Popup picker hiá»ƒn thá»‹ 6 loáº¡i reactions + nÃºt X (xÃ³a)
- LinearLayout horizontal vá»›i 7 FrameLayouts
- Má»—i reaction: 44dp x 44dp container, icon 32dp
- NÃºt X: 44dp x 44dp container, icon 24dp mÃ u xÃ¡m (#757575)
- Padding 4dp, khÃ´ng cÃ³ background (vÃ¬ PopupWindow Ä‘Ã£ cÃ³)

3.2. LAYOUTS Sá»¬A Äá»”I

item_message_sent.xml & item_message_received.xml:
- ThÃªm `reactionsContainer` (LinearLayout horizontal) bÃªn dÆ°á»›i message bubble
- Container bao gá»“m:
  + reactionIcon: ImageView hiá»ƒn thá»‹ reaction phá»• biáº¿n nháº¥t (16dp)
  + reactionCount: TextView hiá»ƒn thá»‹ tá»•ng sá»‘ reactions
  + addReactionButton: ImageView (+) Ä‘á»ƒ thÃªm reaction
- Visibility: GONE (máº·c Ä‘á»‹nh), VISIBLE khi message.hasReactions()
- Background: rounded rectangle (#F0F0F0 cho received, #30FFFFFF cho sent)

3.3. DRAWABLES Má»šI

Reaction icons (32dp, drawable-nodpi):
- ic_reaction_heart.xml (â¤ï¸)
- ic_reaction_haha.xml (ğŸ˜‚)
- ic_reaction_sad.xml (ğŸ˜¢)
- ic_reaction_angry.xml (ğŸ˜ )
- ic_reaction_wow.xml (ğŸ˜®)
- ic_reaction_like.xml (ğŸ‘)

bg_reaction_picker.xml:
- Rounded rectangle background cho reaction picker popup
- Corner radius: 8dp
- Color: #FFFFFF
- Shadow/elevation Ä‘Æ°á»£c set trong PopupWindow

================================================================================
4. REACTION PICKER POPUP
================================================================================

4.1. IMPLEMENTATION (ui/room/ReactionPickerPopup.java)

Class káº¿ thá»«a PopupWindow:
- Layout: layout_reaction_picker.xml
- Hiá»ƒn thá»‹ trÃªn tin nháº¯n (showAboveAnchor)
- Tá»± Ä‘á»™ng dismiss sau khi chá»n reaction
- Scale-in animation khi xuáº¥t hiá»‡n (0.8 â†’ 1.0 trong 150ms)

4.2. POSITIONING

- Hiá»ƒn thá»‹ phÃ­a TRÃŠN tin nháº¯n (16dp margin)
- Center horizontally theo message bubble
- Auto-adjust Ä‘á»ƒ khÃ´ng trÃ n ra ngoÃ i mÃ n hÃ¬nh (16dp margin tá»« edges)
- Pivot point: bottom-center (animation má»c lÃªn tá»« tin nháº¯n)

4.3. INTERACTION

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Action                    â”‚ Behavior                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Click reaction icon       â”‚ ThÃªm/cáº­p nháº­t reaction â†’ dismiss popup        â”‚
â”‚ Click nÃºt X              â”‚ XÃ³a Táº¤T Cáº¢ reactions â†’ dismiss popup          â”‚
â”‚ Click outside            â”‚ Dismiss popup                                  â”‚
â”‚ Back button              â”‚ Dismiss popup                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Callback interface:
```java
public interface OnReactionSelectedListener {
    void onReactionSelected(String reactionType); // null = remove all
}
```

================================================================================
5. REPOSITORY LAYER
================================================================================

5.1. CHAT REPOSITORY (repository/ChatRepository.java)

addReaction(conversationId, messageId, userId, reactionType)
- Validate reaction type
- Sá»­ dá»¥ng Firestore FieldValue.increment(1) Ä‘á»ƒ tÄƒng count atomically
- Update map reactions vá»›i userId â†’ reactionType
- Return LiveData<Resource<Boolean>>

removeReaction(conversationId, messageId, userId)
- XÃ“A Táº¤T Cáº¢ reactions vÃ  counts (khÃ´ng chá»‰ cá»§a user hiá»‡n táº¡i)
- Set reactions = {} (empty map)
- Set reactionCounts = {} (empty map)
- Má»¥c Ä‘Ã­ch: NÃºt X reset toÃ n bá»™ reactions vá» 0
- Return LiveData<Resource<Boolean>>

toggleReaction(conversationId, messageId, userId, reactionType)
- Fetch message hiá»‡n táº¡i
- LuÃ´n luÃ´n add/update reaction (Zalo-style, khÃ´ng toggle off)
- Gá»i addReaction() ná»™i bá»™
- Return LiveData<Resource<Boolean>>

5.2. LOGIC QUAN TRá»ŒNG

Khi user thay Ä‘á»•i reaction (tá»« â¤ï¸ sang ğŸ˜‚):
1. addReaction() Ä‘Æ°á»£c gá»i vá»›i reactionType má»›i
2. Firestore update: reactions.{userId} = "haha"
3. Increment reactionCounts.haha += 1
4. LÆ°u Ã½: Count cá»§a reaction cÅ© (heart) KHÃ”NG tá»± Ä‘á»™ng giáº£m
5. ÄÃ¢y lÃ  intentional behavior - giá»¯ nguyÃªn logic hiá»‡n táº¡i

Khi user nháº¥n nÃºt X:
1. removeReaction() Ä‘Æ°á»£c gá»i
2. Clear toÃ n bá»™ reactions map
3. Clear toÃ n bá»™ reactionCounts map
4. Táº¥t cáº£ users máº¥t reaction â†’ Reset vá» 0

Count management:
- Khi count giáº£m vá» 0 (náº¿u cÃ³ logic decrement), key bá»‹ remove khá»i map
- TrÃ¡nh hiá»ƒn thá»‹ "â¤ï¸ 0" trÃªn UI (key khÃ´ng tá»“n táº¡i = khÃ´ng hiá»ƒn thá»‹)

================================================================================
6. VIEWMODEL LAYER
================================================================================

6.1. ROOM VIEWMODEL (viewmodel/RoomViewModel.java)

Methods:
- toggleReaction(conversationId, messageId, userId, reactionType)
  â†’ Call chatRepository.toggleReaction()
- removeReaction(conversationId, messageId, userId)
  â†’ Call chatRepository.removeReaction()

LiveData observers:
- Observe result vÃ  update UI state
- Handle loading, success, error states

================================================================================
7. ADAPTER LAYER
================================================================================

7.1. MESSAGE ADAPTER (ui/room/MessageAdapter.java)

Interface definitions:
```java
public interface OnMessageReactionListener {
    void onReactionClick(Message message, String reactionType);
    void onReactionLongPress(Message message, View anchorView);
    void onReactionStatsClick(Message message);
}
```

Binding reactions:
- Check message.hasReactions()
- Hiá»ƒn thá»‹ reactionsContainer náº¿u cÃ³
- Bind icon cá»§a reaction phá»• biáº¿n nháº¥t
- Bind tá»•ng sá»‘ reactions
- Set click listeners

DiffUtil callback:
- areContentsTheSame() so sÃ¡nh cáº£ reactions vÃ  reactionCounts maps
- Äáº£m báº£o chá»‰ update item thay Ä‘á»•i, khÃ´ng refresh toÃ n bá»™ list

================================================================================
8. ACTIVITY LAYER
================================================================================

8.1. ROOM ACTIVITY (ui/room/RoomActivity.java)

Setup reaction listener:
```java
messageAdapter.setOnMessageReactionListener(new OnMessageReactionListener() {
    @Override
    public void onReactionClick(Message message, String reactionType) {
        handleReactionClick(message, reactionType);
    }
    
    @Override
    public void onReactionLongPress(Message message, View anchorView) {
        showReactionPicker(message, anchorView);
    }
    
    @Override
    public void onReactionStatsClick(Message message) {
        showReactionStatsDialog(message);
    }
});
```

handleReactionClick(Message, String):
- Láº¥y currentUserId
- Call roomViewModel.toggleReaction()
- ViewModel tá»± Ä‘á»™ng update UI qua LiveData

showReactionPicker(Message, View):
- Táº¡o ReactionPickerPopup instance
- Pass callback: reactionType â†’ toggleReaction (null â†’ removeReaction)
- Show popup phÃ­a trÃªn message bubble

showReactionStatsDialog(Message):
- Build dialog hiá»ƒn thá»‹ thá»‘ng kÃª reactions
- Format: "â¤ï¸ ThÃ­ch: 5\nğŸ˜‚ Haha: 3\n...\nTá»•ng sá»‘ lÆ°á»£t: 8"

================================================================================
9. UI OPTIMIZATION
================================================================================

9.1. NGÄ‚N NHáº¤P NHÃY (Prevent Flicker)

Váº¥n Ä‘á»:
- Khi reaction update, DiffUtil trigger change animation
- RecyclerView máº·c Ä‘á»‹nh cÃ³ fade animation â†’ nháº¥p nhÃ¡y

Giáº£i phÃ¡p:
```java
RecyclerView.ItemAnimator animator = messagesRecyclerView.getItemAnimator();
if (animator instanceof SimpleItemAnimator) {
    ((SimpleItemAnimator) animator).setSupportsChangeAnimations(false);
}
```

Káº¿t quáº£:
- Táº¯t change animation (item thay Ä‘á»•i content)
- Giá»¯ nguyÃªn add/remove animation (item má»›i/xÃ³a)
- Reaction update mÆ°á»£t mÃ , khÃ´ng nháº¥p nhÃ¡y

9.2. NGÄ‚N AUTO-SCROLL KHÃ”NG MONG MUá»N

Váº¥n Ä‘á»:
- Má»—i khi messages LiveData emit, code tá»± Ä‘á»™ng scroll xuá»‘ng cuá»‘i
- User Ä‘ang Ä‘á»c tin cÅ© â†’ reaction update â†’ bá»‹ cuá»™n xuá»‘ng tin má»›i

Giáº£i phÃ¡p:
```java
// Chá»‰ scroll khi cÃ³ tin nháº¯n Má»šI (size tÄƒng)
int oldSize = messages != null ? messages.size() : 0;
int newSize = newMessages.size();
boolean isNewMessage = newSize > oldSize;

if (isNewMessage && messageAdapter.getItemCount() > 0) {
    messagesRecyclerView.scrollToPosition(messageAdapter.getItemCount() - 1);
}
```

Káº¿t quáº£:
- Chá»‰ scroll khi tin nháº¯n Má»šI Ä‘Æ°á»£c thÃªm vÃ o
- Reaction updates KHÃ”NG gÃ¢y scroll
- User cÃ³ thá»ƒ Ä‘á»c tin cÅ© vÃ  reaction thoáº£i mÃ¡i

================================================================================
10. FLOW CHI TIáº¾T
================================================================================

10.1. THÃŠM REACTION

1. User long-press tin nháº¯n
2. ReactionPickerPopup hiá»ƒn thá»‹ phÃ­a trÃªn
3. User click icon â¤ï¸
4. Popup dismiss
5. RoomActivity.handleReactionClick() Ä‘Æ°á»£c gá»i vá»›i "heart"
6. RoomViewModel.toggleReaction() â†’ ChatRepository.addReaction()
7. Firestore update:
   - reactions.{userId} = "heart"
   - reactionCounts.heart += 1 (atomic increment)
8. Firestore snapshot trigger
9. RoomViewModel emit messages LiveData
10. MessageAdapter.updateMessages() vá»›i DiffUtil
11. Chá»‰ item cÃ³ reaction thay Ä‘á»•i Ä‘Æ°á»£c re-bind (khÃ´ng nháº¥p nhÃ¡y)
12. UI hiá»ƒn thá»‹ "â¤ï¸ 1" hoáº·c "â¤ï¸ 5" (náº¿u cÃ³ nhiá»u ngÆ°á»i)

10.2. XÃ“A Táº¤T Cáº¢ REACTIONS (NÃšT X)

1. User long-press tin nháº¯n
2. ReactionPickerPopup hiá»ƒn thá»‹
3. User click nÃºt X
4. Popup dismiss
5. RoomActivity callback vá»›i reactionType = null
6. RoomViewModel.removeReaction() â†’ ChatRepository.removeReaction()
7. Firestore update:
   - reactions = {} (empty map)
   - reactionCounts = {} (empty map)
8. Firestore snapshot trigger
9. UI update: reactionsContainer visibility = GONE
10. Táº¥t cáº£ reactions cá»§a tin nháº¯n bá»‹ xÃ³a (tá»« táº¥t cáº£ users)

10.3. XEM THá»NG KÃŠ REACTIONS

1. User click vÃ o reaction count/icon (onReactionStatsClick)
2. RoomActivity.showReactionStatsDialog() Ä‘Æ°á»£c gá»i
3. Parse message.getReactionCounts() map
4. Build text:
   ```
   Thá»‘ng kÃª cáº£m xÃºc:
   
   â¤ï¸ ThÃ­ch: 5
   ğŸ˜‚ Haha: 3
   ğŸ˜® Wow: 1
   
   Tá»•ng sá»‘ lÆ°á»£t: 9
   ```
5. Hiá»ƒn thá»‹ AlertDialog vá»›i ná»™i dung trÃªn

================================================================================
11. CÃC Váº¤N Äá»€ ÄÃƒ Xá»¬ LÃ
================================================================================

11.1. DOUBLE BACKGROUND

Váº¥n Ä‘á»:
- layout_reaction_picker.xml cÃ³ background + elevation
- ReactionPickerPopup.java cÅ©ng set background
- Káº¿t quáº£: 2 backgrounds chá»“ng lÃªn nhau

Kháº¯c phá»¥c:
- XÃ³a android:background vÃ  android:elevation khá»i XML
- Chá»‰ giá»¯ background trong PopupWindow (Java code)
- Popup hiá»ƒn thá»‹ Ä‘Ãºng 1 background, Ä‘áº¹p hÆ¡n

11.2. REACTION COUNT KHÃ”NG RESET Vá»€ 0

Váº¥n Ä‘á»:
- NÃºt X chá»‰ xÃ³a reaction cá»§a user hiá»‡n táº¡i
- Count giáº£m Ä‘i 1 nhÆ°ng khÃ´ng vá» 0
- CÃ¡c user khÃ¡c váº«n cÃ³ reaction

Kháº¯c phá»¥c:
- Thay Ä‘á»•i logic removeReaction()
- Thay vÃ¬ xÃ³a reaction cá»§a 1 user â†’ xÃ³a Táº¤T Cáº¢
- Set reactions = {}, reactionCounts = {}
- Count reset vá» 0 hoÃ n toÃ n

11.3. MESSAGE FLICKER KHI REACTION

Váº¥n Ä‘á»:
- Item nháº¥p nhÃ¡y khi reaction update
- RecyclerView change animation gÃ¢y fade in/out

Kháº¯c phá»¥c:
- setSupportsChangeAnimations(false)
- Táº¯t change animation, giá»¯ add/remove animation
- UI mÆ°á»£t mÃ  hÆ¡n

11.4. AUTO-SCROLL KHI REACTION TIN NHáº®N CÅ¨

Váº¥n Ä‘á»:
- User Ä‘ang Ä‘á»c tin cÅ©
- Reaction vÃ o tin nháº¯n cÅ©
- Bá»‹ auto-scroll xuá»‘ng tin má»›i nháº¥t

Kháº¯c phá»¥c:
- Kiá»ƒm tra size change trÆ°á»›c khi scroll
- Chá»‰ scroll náº¿u cÃ³ tin nháº¯n Má»šI (size tÄƒng)
- Reaction update khÃ´ng scroll

================================================================================
12. FILES áº¢NH HÆ¯á»NG
================================================================================

12.1. JAVA FILES

models/Message.java:
- ThÃªm Map<String, String> reactions
- ThÃªm Map<String, Integer> reactionCounts
- ThÃªm hasReactions(), getUserReaction(), getTotalReactionCount()

models/MessageReaction.java [NEW]:
- Constants cho 6 loáº¡i reactions
- Helper methods: isValidReactionType(), getReactionTypeCounts(), getMostCommonReaction()

repository/ChatRepository.java:
- addReaction(): ThÃªm reaction vá»›i FieldValue.increment
- removeReaction(): Clear toÃ n bá»™ reactions
- toggleReaction(): Always add (khÃ´ng toggle off)

viewmodel/RoomViewModel.java:
- toggleReaction(): Bridge Ä‘áº¿n repository
- removeReaction(): Bridge Ä‘áº¿n repository

ui/room/ReactionPickerPopup.java [NEW]:
- PopupWindow custom cho reaction picker
- Positioning logic
- Animation vÃ  callbacks

ui/room/MessageAdapter.java:
- ThÃªm OnMessageReactionListener interface
- Bind reaction UI trong all ViewHolders
- Update DiffUtil callback Ä‘á»ƒ so sÃ¡nh reactions

ui/room/RoomActivity.java:
- handleReactionClick(): Xá»­ lÃ½ reaction click
- showReactionPicker(): Hiá»ƒn thá»‹ popup
- showReactionStatsDialog(): Hiá»ƒn thá»‹ thá»‘ng kÃª
- Optimize scroll logic
- Disable change animations

12.2. XML FILES

res/layout/layout_reaction_picker.xml [NEW]
res/layout/item_message_sent.xml [MODIFIED]
res/layout/item_message_received.xml [MODIFIED]
res/drawable/ic_reaction_heart.png [NEW]
res/drawable/ic_reaction_haha.png [NEW]
res/drawable/ic_reaction_sad.png [NEW]
res/drawable/ic_reaction_angry.png [NEW]
res/drawable/ic_reaction_wow.png [NEW]
res/drawable/ic_reaction_like.png [NEW]
res/drawable/bg_reaction_picker.xml [NEW]

================================================================================
13. TESTING CHECKLIST
================================================================================

â–¡ Long-press tin nháº¯n â†’ Reaction picker xuáº¥t hiá»‡n
â–¡ Click reaction icon â†’ Reaction Ä‘Æ°á»£c thÃªm vÃ o tin nháº¯n
â–¡ Click reaction icon khÃ¡c â†’ Reaction thay Ä‘á»•i
â–¡ Click nÃºt X â†’ Táº¤T Cáº¢ reactions bá»‹ xÃ³a (vá» 0)
â–¡ Reaction count hiá»ƒn thá»‹ Ä‘Ãºng sá»‘ lÆ°á»£ng
â–¡ Icon hiá»ƒn thá»‹ reaction phá»• biáº¿n nháº¥t
â–¡ Click vÃ o reactions â†’ Dialog thá»‘ng kÃª hiá»ƒn thá»‹ Ä‘Ãºng
â–¡ Reaction update khÃ´ng gÃ¢y nháº¥p nhÃ¡y item
â–¡ Reaction tin nháº¯n cÅ© khÃ´ng gÃ¢y auto-scroll
â–¡ Popup hiá»ƒn thá»‹ Ä‘Ãºng vá»‹ trÃ­ (phÃ­a trÃªn tin nháº¯n)
â–¡ Popup khÃ´ng trÃ n ra ngoÃ i mÃ n hÃ¬nh
â–¡ Animation mÆ°á»£t mÃ  khi popup xuáº¥t hiá»‡n
â–¡ Popup dismiss sau khi chá»n reaction
â–¡ Multiple users cÃ³ thá»ƒ reaction cÃ¹ng 1 tin nháº¯n
â–¡ Reaction persist sau khi thoÃ¡t vÃ  vÃ o láº¡i app
â–¡ Reaction hiá»ƒn thá»‹ Ä‘Ãºng cho cáº£ tin gá»­i vÃ  nháº­n

================================================================================
14. KNOWN LIMITATIONS
================================================================================

- KhÃ´ng hiá»ƒn thá»‹ danh sÃ¡ch users Ä‘Ã£ react (chá»‰ cÃ³ tá»•ng count)
- KhÃ´ng thá»ƒ xem ai react gÃ¬ (chá»‰ cÃ³ thá»‘ng kÃª tá»•ng quÃ¡t)
- NÃºt X xÃ³a toÃ n bá»™ reactions (khÃ´ng phÃ¢n biá»‡t user)
- KhÃ´ng cÃ³ animation cho reaction icon khi thay Ä‘á»•i
- KhÃ´ng há»— trá»£ custom reactions/stickers
- Reaction picker cá»‘ Ä‘á»‹nh 6 icons (khÃ´ng scroll)

================================================================================
15. FUTURE IMPROVEMENTS
================================================================================

- Hiá»ƒn thá»‹ avatar cá»§a users Ä‘Ã£ react
- Detail dialog: Ai react gÃ¬ (grouped by reaction type)
- Haptic feedback khi react
- Bounce animation cho reaction icon
- Support thÃªm reactions (má»Ÿ rá»™ng picker)
- Reaction tá»« notification
- Analytics: Track popular reactions
- Keyboard shortcut cho reactions (desktop web)

================================================================================
PHIÃŠN Báº¢N
================================================================================

Táº¡o ngÃ y: 21/12/2025
Cáº­p nháº­t láº§n cuá»‘i: 21/12/2025
PhiÃªn báº£n: 1.0
Tráº¡ng thÃ¡i: HoÃ n thÃ nh
